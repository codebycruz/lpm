---
import { Icon } from "astro-icon/components";
import { GITHUB_URL, GITHUB_RELEASES_URL, DISCORD_URL } from "../data/info";
import Search from "./Search.tsx";

const entries = [
	{ display: "Docs", href: "/docs/getting-started/introduction/" },
	{ display: "Blog", href: "/blog/" },
];
---

<nav
	class="h-14 px-4 md:px-6 flex items-center justify-center border-b border-black/50 dark:border-white/50"
>
	<div class="flex flex-row items-center h-full w-full max-w-[90em]">
		<a
			href="/"
			class="font-semibold text-2xl p-2 md:p-4 flex items-center gap-2"
		>
			<img
				src="/lpm-small.svg"
				alt="lpm logo"
				class="size-8 object-contain"
			/>

			lpm
		</a>

		<div
			class="ml-6 md:ml-16 h-full flex flex-row items-center gap-2 md:gap-4"
		>
			{
				entries.map((entry) => (
					<a
						href={entry.href}
						class="hover:bg-gray-800/50 font-medium dark:hover:bg-white/20 px-2 py-1 md:p-4 underline-offset-4 transition rounded-md md:rounded-none"
					>
						{entry.display}
					</a>
				))
			}
		</div>

		<div class="ml-auto mr-2 md:mr-4">
			<Search client:load />
		</div>

		<div class="flex items-center gap-0 md:gap-2">
			<a
				href={GITHUB_RELEASES_URL}
				target="_blank"
				rel="noopener noreferrer"
				class="px-3 py-1.5 bg-blue-500/10 border border-blue-500/30 text-blue-500 text-sm font-medium rounded-lg backdrop-blur-md"
			>
				Download
			</a>
			<a
				href={DISCORD_URL}
				target="_blank"
				rel="noopener noreferrer"
				class="opacity-60 hover:opacity-100 p-2 md:p-4 transition-opacity"
			>
				<Icon name="simple-icons:discord" class="size-5 md:size-6" />
			</a>
			<a
				href={GITHUB_URL}
				target="_blank"
				rel="noopener noreferrer"
				class="opacity-60 hover:opacity-100 p-2 md:p-4 transition-opacity"
			>
				<Icon name="simple-icons:github" class="size-5 md:size-6" />
			</a>
			<button
				id="theme-toggle"
				aria-label="Toggle dark/light mode"
				class="opacity-60 hover:opacity-100 p-2 md:p-4 transition-opacity cursor-pointer"
			>
				<!-- Moon: shown in light mode -->
				<svg class="icon-moon size-5 md:size-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
					<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
				</svg>
				<!-- Sun: shown in dark mode -->
				<svg class="icon-sun size-5 md:size-6 hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
					<circle cx="12" cy="12" r="5"/>
					<line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
					<line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
					<line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
					<line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
					<line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
					<line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
					<line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
					<line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
				</svg>
			</button>
		</div>

<script>
	const btn = document.getElementById("theme-toggle")!;
	const html = document.documentElement;

	function updateIcon() {
		const isDark = html.classList.contains("dark");
		(btn.querySelector(".icon-moon") as HTMLElement).classList.toggle("hidden", isDark);
		(btn.querySelector(".icon-sun") as HTMLElement).classList.toggle("hidden", !isDark);
	}

	updateIcon();

	btn.addEventListener("click", () => {
		html.classList.toggle("dark");
		localStorage.setItem("theme", html.classList.contains("dark") ? "dark" : "light");
		updateIcon();
	});
</script>
	</div>
</nav>
